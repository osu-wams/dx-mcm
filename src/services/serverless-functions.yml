createMessageListener:
  handler: src/services/messages/createMessageListener.handler
  name: ${self:service.name}-createMessageListener
  description:
    !Join [' ', ['Listens to SNS Topic', !GetAtt apiSnsTopic.TopicName, 'to create new Messages.']]
  environment:
    SQS_PUBLISH_QUEUE_NAME: !GetAtt messagesSqsQueue.QueueName
  events:
    - sns:
        arn: !Ref apiSnsTopic
        topicName: ${self:service.name}-api # sadly, this has to be a string and can't be !GetAtt due to a bug, see https://github.com/serverless/serverless/issues/3824#issuecomment-436533656
        filterPolicy:
          action:
            - /api/v1/messages/create
